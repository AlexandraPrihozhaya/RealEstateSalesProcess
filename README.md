# RealEstateSalesProcessüè°
***–ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ —Å—Ä–µ–¥—Å—Ç–≤–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∫—É–ø–ª–∏-–ø—Ä–æ–¥–∞–∂–∏ –∂–∏–ª–æ–π –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ —Ä–∏—ç–ª—Ç–æ—Ä—Å–∫–æ–µ –∞–≥–µ–Ω—Ç—Å—Ç–≤–æ***

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ü–°

–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ü–° –≤ –Ω–æ—Ç–∞—Ü–∏–∏ C4-–º–æ–¥–µ–ª—å. –ù–∏–∂–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω—ã–π –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω—ã–π —É—Ä–æ–≤–Ω–∏.

–î–∏–∞–≥—Ä–∞–º–º–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

![–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã C4 drawio](https://github.com/user-attachments/assets/9f6aa4a4-985d-4e12-83c0-6fdbdd372ae3)

–î–∏–∞–≥—Ä–∞–º–º–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

![–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –°4 drawio](https://github.com/user-attachments/assets/d1775589-b525-4c75-86f2-ba54a534d432)

–°–∏—Å—Ç–µ–º–∞ –¥–∏–∑–∞–π–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

![UI Kit](https://github.com/user-attachments/assets/7a443bea-d0a0-40cc-819c-e2ef80520250)

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–°—Ö–µ–º–∞ –ë–î

![image_2024-10-21_12-09-37](https://github.com/user-attachments/assets/95664975-de2c-4497-b808-54a9668e826e)

## –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

### User-flow –¥–∏–∞–≥—Ä–∞–º–º—ã

User-flow –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

![user](https://github.com/user-attachments/assets/3e9700ae-e5ad-4d4a-9f45-c972a086633e)

User-flow –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞

![client](https://github.com/user-attachments/assets/aba98c22-e21e-4293-bd66-f3c81bb0f7ad)

User-flow –¥–ª—è —Ä–∏—ç–ª—Ç–æ—Ä–∞

![realtor](https://github.com/user-attachments/assets/fac1a0e7-ce26-40cc-ba19-5e83e613fdc4)

User-flow –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

![admin](https://github.com/user-attachments/assets/77d781db-76da-430e-886f-7fa145324dcd)

### –ü—Ä–∏–º–µ—Ä—ã —ç–∫—Ä–∞–Ω–æ–≤ UI

![image](https://github.com/user-attachments/assets/e9d4c243-5025-4b6b-b7e4-967be2bee9bd)

![image](https://github.com/user-attachments/assets/65738337-1ace-4a08-b683-ba0518471bc7)

![image](https://github.com/user-attachments/assets/45f5f8a5-33b3-4d3f-8a5e-aa5335e0edcc)

![image](https://github.com/user-attachments/assets/f6416eb6-ba76-480a-9cc2-b5d5b1c82861)

![image](https://github.com/user-attachments/assets/359051ae-21ec-40a3-88c6-4fc8bdba2f0c)

![image](https://github.com/user-attachments/assets/b6f5d483-8adb-4bb0-ab57-8c15c5d123a1)

![image](https://github.com/user-attachments/assets/47b7ca14-e444-48fd-a314-7d6abc7f6427)

![image](https://github.com/user-attachments/assets/769ad750-2419-4937-b179-545b40934e08)

![image](https://github.com/user-attachments/assets/19091e14-951f-4a1e-8bce-eb635edad3de)

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

–í —Å–∏—Å—Ç–µ–º–µ –µ—Å—Ç—å —Ä–∞–∑–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞, —Ç–æ –µ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ä–æ–ª—è–º.
–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Å –ø–æ–º–æ—â—å—é Spring Security –∏ JWT-—Ç–æ–∫–µ–Ω–æ–≤. 
–ö–æ–¥ –Ω–∏–∂–µ –Ω–∞ Java –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Spring Security –¥–ª—è –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

```ruby
public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
    http.csrf(AbstractHttpConfigurer :: disable)
            .exceptionHandling(
                    exception -> exception.authenticationEntryPoint(jwtAuthEntryPoint))
            .sessionManagement(session -> session.sessionCreationPolicy(SessionCreationPolicy.STATELESS))
            .authorizeHttpRequests(auth -> auth
                    .requestMatchers("/auth/**")
                    .permitAll().requestMatchers("/roles/**").hasRole("ADMIN")
                    .anyRequest().authenticated());
    http.authenticationProvider(authenticationProvider());
    http.addFilterBefore(authenticationTokenFilter(), UsernamePasswordAuthenticationFilter.class);
    return http.build();
}
```

–ù–∏–∂–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥, –≥–µ–Ω–µ—Ä–∏—Ä—É—é—â–∏–π —Ç–æ–∫–µ–Ω—ã.

```ruby
public String generateJwtTokenForUser(Authentication authentication){
    AgencyUserDetails userPrincipal = (AgencyUserDetails) authentication.getPrincipal();
    List<String> roles = userPrincipal.getAuthorities()
            .stream()
            .map(GrantedAuthority::getAuthority).toList();
    return Jwts.builder()
            .setSubject(userPrincipal.getUsername())
            .claim("roles", roles)
            .setIssuedAt(new Date())
            .setExpiration(new Date((new Date()).getTime()+jwtExpirationMs))
            .signWith(key(), SignatureAlgorithm.HS256).compact();
}
```

–ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Ö–æ–¥–∏—Ç –≤ —Å–∏—Å—Ç–µ–º—É, —Å–µ—Ä–≤–µ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –µ–≥–æ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏, –µ—Å–ª–∏ –æ–Ω–∏ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã, —Å–æ–∑–¥–∞–µ—Ç –∏ –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç JWT-—Ç–æ–∫–µ–Ω. –≠—Ç–æ—Ç —Ç–æ–∫–µ–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ, —Ç–∞–∫—É—é –∫–∞–∫ –µ–≥–æ email –∏ –ø–∞—Ä–æ–ª—å.

```ruby
@PostMapping("/login")
public ResponseEntity<?> authenticateUser(@Valid @RequestBody LoginRequest request){
    Authentication authentication =
            authenticationManager
                    .authenticate(new UsernamePasswordAuthenticationToken(request.getEmail(), request.getPassword()));
    SecurityContextHolder.getContext().setAuthentication(authentication);
    String jwt = jwtUtils.generateJwtTokenForUser(authentication);
    AgencyUserDetails userDetails = (AgencyUserDetails) authentication.getPrincipal();
    List<String> roles = userDetails.getAuthorities()
            .stream()
            .map(GrantedAuthority::getAuthority).toList();
    return ResponseEntity.ok(new JwtResponse(
            userDetails.getId(),
            userDetails.getEmail(),
            jwt,
            roles));
}
```

–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —Å –ø–æ–º–æ—â—å—é –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∞ –ø–∞—Ä–æ–ª–µ–π `PasswordEncoder`.

```ruby
user.setPassword(passwordEncoder.encode(user.getPassword()));
```

–¢–∞–∫, –ø–∞—Ä–æ–ª–∏ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ.

![image](https://github.com/user-attachments/assets/85f0e59c-4321-4c30-b022-37c99c138a2c)

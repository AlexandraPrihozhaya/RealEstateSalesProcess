# RealEstateSalesProcessüè°
***–ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ —Å—Ä–µ–¥—Å—Ç–≤–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∫—É–ø–ª–∏-–ø—Ä–æ–¥–∞–∂–∏ –∂–∏–ª–æ–π –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ —Ä–∏—ç–ª—Ç–æ—Ä—Å–∫–æ–µ –∞–≥–µ–Ω—Ç—Å—Ç–≤–æ***

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ü–°

–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ü–° –≤ –Ω–æ—Ç–∞—Ü–∏–∏ C4-–º–æ–¥–µ–ª—å. –ù–∏–∂–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω—ã–π –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω—ã–π —É—Ä–æ–≤–Ω–∏.

–î–∏–∞–≥—Ä–∞–º–º–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

![–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã C4 drawio](https://github.com/user-attachments/assets/9f6aa4a4-985d-4e12-83c0-6fdbdd372ae3)

–î–∏–∞–≥—Ä–∞–º–º–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

![–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –°4 drawio](https://github.com/user-attachments/assets/d1775589-b525-4c75-86f2-ba54a534d432)

–°–∏—Å—Ç–µ–º–∞ –¥–∏–∑–∞–π–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

![UI Kit](https://github.com/user-attachments/assets/7a443bea-d0a0-40cc-819c-e2ef80520250)

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–°—Ö–µ–º–∞ –ë–î

![image_2024-10-21_12-09-37](https://github.com/user-attachments/assets/95664975-de2c-4497-b808-54a9668e826e)

–î–∏–∞–≥—Ä–∞–º–º–∞ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

![image_2024-11-29_17-42-10](https://github.com/user-attachments/assets/a5bc7695-da4f-45fa-9e16-7b9b56058d9e)

–î–∏–∞–≥—Ä–∞–º–º–∞ –∫–ª–∞—Å—Å–æ–≤

![–¥–∏–∞–≥—Ä–∞–º–º–∞ –∫–ª–∞—Å—Å–æ–≤ drawio](https://github.com/user-attachments/assets/c8a8220a-1fe4-4db9-9b01-df907d9cc539)

–î–∏–∞–≥—Ä–∞–º–º–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π –∑–∞—è–≤–∫–∏ –Ω–∞ –ø–æ–∫—É–ø–∫—É/–ø—Ä–æ–¥–∞–∂—É –æ–±—ä–µ–∫—Ç–∞ –∂–∏–ª–æ–π –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏

![Untitled](https://github.com/user-attachments/assets/540d16d9-c0c8-400d-b50a-09753544929f)

–î–∏–∞–≥—Ä–∞–º–º–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ ¬´–ü–æ–¥–∞—Ç—å –∑–∞—è–≤–∫—É –Ω–∞ –ø–æ–∫—É–ø–∫—É –æ–±—ä–µ–∫—Ç–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏¬ª

![–¥–∏–∞–≥—Ä–∞–º–º–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏](https://github.com/user-attachments/assets/a0da2a92-5de8-4a4f-bc18-331004dce98f)

–î–∏–∞–≥—Ä–∞–º–º–∞ –ø—Ä–µ—Ü–µ–¥–µ–Ω—Ç–æ–≤ (–≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)

![Untitled (5)](https://github.com/user-attachments/assets/d04edbeb-3684-46b1-a7d5-95cf419dbac3)

–î–∏–∞–≥—Ä–∞–º–º–∞ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ ¬´–î–æ–±–∞–≤–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –æ –ø—Ä–æ–¥–∞–∂–µ¬ª

![–¥–∏–∞–≥—Ä–∞–º–º–∞ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (1)](https://github.com/user-attachments/assets/90615e17-c9f6-422b-93f5-d506a8c09e85)

–°—Ö–µ–º–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∫—É–ø–ª–∏-–ø—Ä–æ–¥–∞–∂–∏ –æ–±—ä–µ–∫—Ç–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏

![—Å—Ö–µ–º–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ 2](https://github.com/user-attachments/assets/eacba32e-e9bd-4107-8988-533cc018f350)

–°—Ö–µ–º–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø–æ–¥–∞—á–∏ –∑–∞—è–≤–∫–∏ –Ω–∞ –ø–æ–∫—É–ø–∫—É –æ–±—ä–µ–∫—Ç–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏

![—Å—Ö–µ–º–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–∞](https://github.com/user-attachments/assets/59dedcee-eeae-4c6d-941a-1988d0c4a7c1)

## –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

### User-flow –¥–∏–∞–≥—Ä–∞–º–º—ã

User-flow –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

![user](https://github.com/user-attachments/assets/3e9700ae-e5ad-4d4a-9f45-c972a086633e)

User-flow –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞

![client](https://github.com/user-attachments/assets/aba98c22-e21e-4293-bd66-f3c81bb0f7ad)

User-flow –¥–ª—è —Ä–∏—ç–ª—Ç–æ—Ä–∞

![realtor](https://github.com/user-attachments/assets/fac1a0e7-ce26-40cc-ba19-5e83e613fdc4)

User-flow –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

![admin](https://github.com/user-attachments/assets/77d781db-76da-430e-886f-7fa145324dcd)

### –ü—Ä–∏–º–µ—Ä—ã —ç–∫—Ä–∞–Ω–æ–≤ UI

![image](https://github.com/user-attachments/assets/6b57ba1d-e3a2-46fe-9c0c-331ec9f84a19)

![image](https://github.com/user-attachments/assets/12e2cc41-07a0-4076-ba78-109650c476a9)

![image](https://github.com/user-attachments/assets/e40e079c-0630-4dad-a8a5-06fc7e1801b8)

![image](https://github.com/user-attachments/assets/e9a20171-bc23-4c6a-a5b8-392853102217)

![image](https://github.com/user-attachments/assets/8b73bb67-2f73-4363-90aa-61bbae4c0a90)

![image](https://github.com/user-attachments/assets/8353fa23-db72-4a3c-b1ae-cb871ee3cb49)

![image](https://github.com/user-attachments/assets/f231cbf0-d935-4d8b-927d-938c5e23f710)

![image](https://github.com/user-attachments/assets/04230ff1-87cc-4326-ac10-7e26dc5fbf7b)

![image](https://github.com/user-attachments/assets/1cdd4e59-2021-42ad-abbe-d7a39df9eae0)

![image](https://github.com/user-attachments/assets/f5177ea5-e5a4-4f59-9584-57b29ad9d967)

![image](https://github.com/user-attachments/assets/2a4a1814-5967-4306-bb84-244d61741365)

![image](https://github.com/user-attachments/assets/002ac90b-eb53-4f58-bd33-cc707de94fb5)

![image](https://github.com/user-attachments/assets/2cf0d182-5a88-4398-ae44-099bdd27e32c)

![image](https://github.com/user-attachments/assets/90831344-b72a-4be5-91be-a3903f63efdb)

![image](https://github.com/user-attachments/assets/4e81af77-393a-4bef-9298-db4025844829)

![image](https://github.com/user-attachments/assets/755f3f47-11a4-4078-839d-8de354493766)

![image](https://github.com/user-attachments/assets/1fca8b77-a636-449f-9ddc-72c1aa95420c)

![image](https://github.com/user-attachments/assets/c84ed776-34bc-40cd-9229-8dec0e047ada)

![image](https://github.com/user-attachments/assets/4dcd936d-e4b7-4ac2-8b15-2cf13e89afe1)

![image](https://github.com/user-attachments/assets/6df24846-e2ed-4101-833d-2d9c24c1a8a1)

![image](https://github.com/user-attachments/assets/ad18bf40-6f71-4261-a827-ccf9901a61f4)

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

–í —Å–∏—Å—Ç–µ–º–µ –µ—Å—Ç—å —Ä–∞–∑–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞, —Ç–æ –µ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ä–æ–ª—è–º.
–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Å –ø–æ–º–æ—â—å—é Spring Security –∏ JWT-—Ç–æ–∫–µ–Ω–æ–≤. 
–ö–æ–¥ –Ω–∏–∂–µ –Ω–∞ Java –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Spring Security –¥–ª—è –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

```ruby
public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
    http.csrf(AbstractHttpConfigurer :: disable)
            .exceptionHandling(
                    exception -> exception.authenticationEntryPoint(jwtAuthEntryPoint))
            .sessionManagement(session -> session.sessionCreationPolicy(SessionCreationPolicy.STATELESS))
            .authorizeHttpRequests(auth -> auth
                    .requestMatchers("/auth/**")
                    .permitAll().requestMatchers("/roles/**").hasRole("ADMIN")
                    .anyRequest().authenticated());
    http.authenticationProvider(authenticationProvider());
    http.addFilterBefore(authenticationTokenFilter(), UsernamePasswordAuthenticationFilter.class);
    return http.build();
}
```

–ù–∏–∂–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥, –≥–µ–Ω–µ—Ä–∏—Ä—É—é—â–∏–π —Ç–æ–∫–µ–Ω—ã.

```ruby
public String generateJwtTokenForUser(Authentication authentication){
    AgencyUserDetails userPrincipal = (AgencyUserDetails) authentication.getPrincipal();
    List<String> roles = userPrincipal.getAuthorities()
            .stream()
            .map(GrantedAuthority::getAuthority).toList();
    return Jwts.builder()
            .setSubject(userPrincipal.getUsername())
            .claim("roles", roles)
            .setIssuedAt(new Date())
            .setExpiration(new Date((new Date()).getTime()+jwtExpirationMs))
            .signWith(key(), SignatureAlgorithm.HS256).compact();
}
```

–ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Ö–æ–¥–∏—Ç –≤ —Å–∏—Å—Ç–µ–º—É, —Å–µ—Ä–≤–µ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –µ–≥–æ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏, –µ—Å–ª–∏ –æ–Ω–∏ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã, —Å–æ–∑–¥–∞–µ—Ç –∏ –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç JWT-—Ç–æ–∫–µ–Ω. –≠—Ç–æ—Ç —Ç–æ–∫–µ–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ, —Ç–∞–∫—É—é –∫–∞–∫ –µ–≥–æ email –∏ –ø–∞—Ä–æ–ª—å.

```ruby
@PostMapping("/login")
public ResponseEntity<?> authenticateUser(@Valid @RequestBody LoginRequest request){
    Authentication authentication =
            authenticationManager
                    .authenticate(new UsernamePasswordAuthenticationToken(request.getEmail(), request.getPassword()));
    SecurityContextHolder.getContext().setAuthentication(authentication);
    String jwt = jwtUtils.generateJwtTokenForUser(authentication);
    AgencyUserDetails userDetails = (AgencyUserDetails) authentication.getPrincipal();
    List<String> roles = userDetails.getAuthorities()
            .stream()
            .map(GrantedAuthority::getAuthority).toList();
    return ResponseEntity.ok(new JwtResponse(
            userDetails.getId(),
            userDetails.getEmail(),
            jwt,
            roles));
}
```

–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —Å –ø–æ–º–æ—â—å—é –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∞ –ø–∞—Ä–æ–ª–µ–π `PasswordEncoder`.

```ruby
user.setPassword(passwordEncoder.encode(user.getPassword()));
```

–¢–∞–∫, –ø–∞—Ä–æ–ª–∏ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ.

![image](https://github.com/user-attachments/assets/85f0e59c-4321-4c30-b022-37c99c138a2c)

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∫ API

```
openapi: 3.0.3
info:
  title: Real estate purchase and sale service OpenApi specification
  version: 0.0.1
servers:
  - url: http://localhost:8080
paths: 
  /users/all:
    get:
      summary: Method for getting a list of users
      tags:
        - users
      operationId: getUsers
      responses:
        '200': 
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Users"
        '401':
          description: Full authentication is required to access this resource
  /users/user/{email}:
    get:
      summary: Method for getting user by email
      tags:
        - users
      operationId: getUserByEmail
      parameters:
        - name: email
          in: path
          description: User email to search for him
          required: true
          schema:
            type: string
      responses:
        '200': 
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
        '400':
          description: Invalid email
        '401':
          description: Full authentication is required to access this resource
  /users/delete/{email}:
    delete:
      summary: Method for deleting user by email
      tags:
        - users
      operationId: deleteUser
      parameters:
        - name: email
          in: path
          description: User email to delete him
          required: true
          schema:
            type: string
      responses:
        '400':
          description: Invalid email
        '401':
          description: Full authentication is required to access this resource
  /users/update:
    put:
      summary: Method for changing a user's role
      tags:
        - users
      operationId: updateUser
      requestBody:
        required: false
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/User"
      responses:
        '200': 
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
        '400':
          description: Invalid input
        '401':
          description: Full authentication is required to access this resource          
  /users/user-id-{userId}:
    get:
      summary: Method for getting user by id
      tags:
        - users
      operationId: getUserById
      parameters:
        - name: userId
          in: path
          description: User id to search for him
          required: true
          schema:
            type: string
      responses:
        '200': 
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
        '400':
          description: Invalid id
        '401':
          description: Full authentication is required to access this resource
  /realtors/all:
    get:
      summary: Method for getting a list of realtors
      tags:
        - realtors
      operationId: getRealtors
      responses:
        '200': 
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Realtors"
        '401':
          description: Full authentication is required to access this resource
  /realtors/realtor-id-{realtorId}:
    get:
      summary: Method for getting realtor by id
      tags:
        - realtors
      operationId: getRealtorById
      parameters:
        - name: realtorId
          in: path
          description: Realtor id to search for him
          required: true
          schema:
            type: string
      responses:
        '200': 
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Realtor"
        '400':
          description: Invalid id
        '401':
          description: Full authentication is required to access this resource
  /realtors/delete/{realtorId}:
    delete:
      summary: Method for deleting realtor by id
      tags:
        - realtors
      operationId: deleteRealtor
      parameters:
        - name: realtorId
          in: path
          description: Realtor id to delete him
          required: true
          schema:
            type: string
      responses:
        '400':
          description: Invalid id
        '401':
          description: Full authentication is required to access this resource
  /realtors/update/{realtorId}:
    put:
      summary: Method for changing realtor data by id
      tags:
        - realtors
      operationId: updateRealtor
      requestBody:
        required: false
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Realtor"
      parameters:
        - name: realtorId
          in: path
          description: Realtor id to change him
          required: true
          schema:
            type: string
      responses:
        '200': 
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
        '400':
          description: Invalid id
        '401':
          description: Full authentication is required to access this resource  
  /realtors/updateRealtor/{email}:
    put:
      summary: Method for changing realtor data by email
      tags:
        - realtors
      operationId: updateRealtorByEmail
      requestBody:
        required: false
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Realtor"
      parameters:
        - name: email
          in: path
          description: Realtor email to change him
          required: true
          schema:
            type: string
      responses:
        '200': 
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
        '400':
          description: Invalid email
        '401':
          description: Full authentication is required to access this resource
  /realtors/realtor-email-{email}:
    get:
      summary: Method for getting realtor by email
      tags:
        - realtors
      operationId: getRealtorByEmail
      parameters:
        - name: email
          in: path
          description: Realtor email to search for him
          required: true
          schema:
            type: string
      responses:
        '200': 
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Realtor"
        '400':
          description: Invalid email
        '401':
          description: Full authentication is required to access this resource
  /auth/register:
    post:
      summary: Method for registration user in the system
      tags:
        - auth
      operationId: registerUser
      requestBody:
        required: false
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/User"
      responses:
        '200': 
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
        '400':
          description: Invalid input
  /auth/login:
    post:
      summary: Method for authorization user in the system
      tags:
        - auth
      operationId: authenticateUser
      requestBody:
        required: false
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/User"
      responses:
        '200': 
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
        '400':
          description: Invalid input          
components:
  schemas:
    User:
      type: object
      required:
        - email
        - password
        - role
      properties:
        id:
          type: string
          example: 25
        email:
          type: string
          example: prihsasha@mail.ru
        password:
          type: string
          example: 191719Sp##
        role:
          $ref: "#/components/schemas/Role"
    Users:
      type: array
      items: 
        $ref: "#/components/schemas/User"
    Realtor:
      type: object
      required:
        - secondName
        - firstName
        - phoneNumber
        - user
      properties:
        id:
          type: string
          example: 25
        secondName:
          type: string
          example: Prikhozhaya
        firstName:
          type: string
          example: Alexandra
        patronymic:
          type: string
          example: Vasilevna
        phoneNumber:
          type: string
          example: +375294792847
        user:
          $ref: "#/components/schemas/User"
    Realtors:
      type: array
      items: 
        $ref: "#/components/schemas/Realtor"      
    Role:
      type: object
      required:
        - name
      properties:
        id:
          type: string
          example: 3
        name:
          type: string
          example: ROLE_ADMIN
```






